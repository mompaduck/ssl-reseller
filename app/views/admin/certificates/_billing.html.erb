<%= turbo_frame_tag "certificate_tab_content" do %>
<div id="content-billing" class="tab-content">
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">

    <div class="flex items-center justify-between mb-4">
      <h2 class="text-lg font-bold text-gray-900 flex items-center gap-2">
        <i data-lucide="shopping-cart" class="w-5 h-5 text-purple-600"></i>
        주문 정보 (Order Information)
      </h2>

      <%= link_to admin_order_path(@certificate.order),
        class:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1" do %>
        상세보기 <i data-lucide="external-link" class="w-3 h-3"></i>
      <% end %>
    </div>

    <div class="space-y-3 text-sm">

      <div>
        <p class="text-xs text-gray-500">Internal Order ID</p>
        <p class="font-semibold font-mono text-gray-900"><%= @certificate.order.internal_order_id %></p>
      </div>

      <div>
        <p class="text-xs text-gray-500">Sectigo Order Number</p>
        <p class="font-medium font-mono text-gray-900"><%= @certificate.order.partner_order_number || "-" %></p>
      </div>

      <div>
        <p class="text-xs text-gray-500">주문일</p>
        <p class="text-gray-900"><%= @certificate.order.created_at.strftime("%Y-%m-%d %H:%M") %></p>
      </div>

      <%
      payment_cfg = {
        "pending"  => { color:"bg-yellow-100 text-yellow-800", label:"Pending" },
        "paid"     => { color:"bg-green-100  text-green-800",  label:"Paid" },
        "refunded" => { color:"bg-orange-100 text-orange-800", label:"Refunded" },
        "canceled" => { color:"bg-gray-100   text-gray-800",   label:"Canceled" }
      }[@certificate.order.status] || { color: "bg-gray-100 text-gray-800", label: (@certificate.order.status || "Unknown").to_s.upcase }
      %>

      <div>
        <p class="text-xs text-gray-500">결제 상태</p>
        <span class="px-2 py-1 rounded-full text-xs font-semibold <%= payment_cfg[:color] %>">
          <%= payment_cfg[:label] %>
        </span>
      </div>

      <%# Pricing %>
      <div class="pt-3 border-t space-y-2">
        <p class="text-xs font-semibold text-gray-700">가격 정보</p>

        <div class="flex justify-between text-xs">
          <span>판매가</span>
          <span class="font-bold text-gray-900">₩<%= number_with_delimiter(@certificate.order.total_price) %></span>
        </div>

        <% if @certificate.order.product&.selling_price %>
          <div class="flex justify-between text-xs">
            <span>제품 단가</span>
            <span class="text-gray-700">₩<%= number_with_delimiter(@certificate.order.product.selling_price) %></span>
          </div>
        <% end %>

        <% if @certificate.order.quantity.to_i > 1 %>
          <div class="flex justify-between text-xs">
            <span>수량</span>
            <span><%= @certificate.order.quantity %></span>
          </div>
        <% end %>
      </div>

    </div>
  </div>
</div>

<% end %>
